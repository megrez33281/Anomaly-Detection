Using device: cuda
Training set size: 2903
Validation set size: 726
Validation Strategy: CutPaste (for object class)
Debug mode enabled. Checkpoints will be saved to: C:\齊齊\交大\課程\資料探勘\作業\作業二：Anomaly Detection\epoch_checkpoints
Starting full training and validation pipeline...
Epoch 1/5 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [01:54<00:00,  1.59it/s] 
Epoch 1/5 [Val]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:39<00:00,  2.32it/s] 

----- DEBUG INFO FOR EPOCH 1 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: -1.8994/0.9100/0.9430/1.4806
  -> class 0: count=726, mean_score=0.910057, std=0.154729
  -> class 1: count=726, mean_score=0.910008, std=0.154770
ROC AUC (as-is): 0.4999
ROC AUC (inverted scores): 0.5001
NOTE: Scores might be inverted. Higher score may mean more normal.
-------------------------------------

Epoch [1/5], Avg Train Loss: 0.8841, Validation AUROC: 0.4999
Epoch 2/5 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [01:54<00:00,  1.60it/s] 
Epoch 2/5 [Val]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:39<00:00,  2.33it/s] 

----- DEBUG INFO FOR EPOCH 2 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.5000/0.9458/0.9826/2.0104
  -> class 0: count=726, mean_score=0.945699, std=0.149425
  -> class 1: count=726, mean_score=0.945874, std=0.149747
ROC AUC (as-is): 0.5000
-------------------------------------

Epoch [2/5], Avg Train Loss: 0.9322, Validation AUROC: 0.5000
Epoch 3/5 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [01:53<00:00,  1.60it/s] 
Epoch 3/5 [Val]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:39<00:00,  2.33it/s] 

----- DEBUG INFO FOR EPOCH 3 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: -0.6984/0.9125/0.9483/2.2972
  -> class 0: count=726, mean_score=0.912453, std=0.160887
  -> class 1: count=726, mean_score=0.912637, std=0.160823
ROC AUC (as-is): 0.5004
-------------------------------------

Epoch [3/5], Avg Train Loss: 0.9311, Validation AUROC: 0.5004
Epoch 4/5 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [01:54<00:00,  1.59it/s] 
Epoch 4/5 [Val]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:39<00:00,  2.33it/s] 

----- DEBUG INFO FOR EPOCH 4 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.3681/0.9266/0.9080/4.1190
  -> class 0: count=726, mean_score=0.926250, std=0.150810
  -> class 1: count=726, mean_score=0.926960, std=0.154003
ROC AUC (as-is): 0.5008
-------------------------------------

Epoch [4/5], Avg Train Loss: 0.9238, Validation AUROC: 0.5008
Epoch 5/5 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [01:53<00:00,  1.60it/s] 
Epoch 5/5 [Val]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:38<00:00,  2.34it/s] 

----- DEBUG INFO FOR EPOCH 5 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: -1.7114/0.9150/0.9076/4.2581
  -> class 0: count=726, mean_score=0.913029, std=0.142127
  -> class 1: count=726, mean_score=0.917003, std=0.188265
ROC AUC (as-is): 0.4992
ROC AUC (inverted scores): 0.5008
NOTE: Scores might be inverted. Higher score may mean more normal.
-------------------------------------

Epoch [5/5], Avg Train Loss: 0.9168, Validation AUROC: 0.4992

Training and validation complete.
Best validation AUROC achieved: 0.0000