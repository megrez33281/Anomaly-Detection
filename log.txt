Using device: cuda
Training set size: 2903
Validation set size: 726
Validation Strategy: CutPaste (for object class)
Downloading: "https://download.pytorch.org/models/vgg16-397923af.pth" to C:\Users\apple/.cache\torch\hub\checkpoints\vgg16-397923af.pth
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 528M/528M [00:21<00:00, 25.3MB/s]
Debug mode enabled. Checkpoints will be saved to: C:\齊齊\交大\課程\資料探勘\作業\作業二：Anomaly Detection\epoch_checkpoints
Starting full training and validation pipeline...
Epoch 1/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:54<00:00,  1.04it/s] 
Epoch 1/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [01:03<00:00,  1.43it/s] 

----- DEBUG INFO FOR EPOCH 1 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.4731/0.5972/0.6015/0.7064
  -> class 0: count=726, mean_score=0.594775, std=0.045235
  -> class 1: count=726, mean_score=0.599617, std=0.044524
ROC AUC (as-is): 0.5266
-------------------------------------

Epoch [1/10], Avg Train Loss: 1.1545, Validation AUROC: 0.5266
Epoch 2/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:51<00:00,  1.06it/s]
Epoch 2/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [01:03<00:00,  1.43it/s] 

----- DEBUG INFO FOR EPOCH 2 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.3364/0.4392/0.4407/0.5422
  -> class 0: count=726, mean_score=0.437284, std=0.040215
  -> class 1: count=726, mean_score=0.441042, std=0.039833
ROC AUC (as-is): 0.5220
-------------------------------------

Epoch [2/10], Avg Train Loss: 0.5036, Validation AUROC: 0.5220
Epoch 3/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:33<00:00,  1.18it/s]
Epoch 3/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:50<00:00,  1.82it/s] 

----- DEBUG INFO FOR EPOCH 3 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.2857/0.3742/0.3739/0.4801
  -> class 0: count=726, mean_score=0.372324, std=0.036905
  -> class 1: count=726, mean_score=0.375987, std=0.037514
ROC AUC (as-is): 0.5238
-------------------------------------

Epoch [3/10], Avg Train Loss: 0.4046, Validation AUROC: 0.5238
Epoch 4/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:34<00:00,  1.18it/s] 
Epoch 4/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [01:04<00:00,  1.42it/s] 

----- DEBUG INFO FOR EPOCH 4 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.2571/0.3358/0.3335/0.4360
  -> class 0: count=726, mean_score=0.334334, std=0.033179
  -> class 1: count=726, mean_score=0.337308, std=0.034517
ROC AUC (as-is): 0.5209
-------------------------------------

Epoch [4/10], Avg Train Loss: 0.3538, Validation AUROC: 0.5209
Epoch 5/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:52<00:00,  1.05it/s]
Epoch 5/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [01:04<00:00,  1.41it/s] 

----- DEBUG INFO FOR EPOCH 5 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.2242/0.3007/0.2989/0.3941
  -> class 0: count=726, mean_score=0.299164, std=0.031405
  -> class 1: count=726, mean_score=0.302269, std=0.032523
ROC AUC (as-is): 0.5237
-------------------------------------

Epoch [5/10], Avg Train Loss: 0.3187, Validation AUROC: 0.5237
Epoch 6/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:52<00:00,  1.05it/s] 
Epoch 6/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:52<00:00,  1.73it/s] 

----- DEBUG INFO FOR EPOCH 6 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.2040/0.2742/0.2724/0.3621
  -> class 0: count=726, mean_score=0.272573, std=0.028967
  -> class 1: count=726, mean_score=0.275787, std=0.030013
ROC AUC (as-is): 0.5276
-------------------------------------

Epoch [6/10], Avg Train Loss: 0.2929, Validation AUROC: 0.5276
Epoch 7/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:27<00:00,  1.23it/s] 
Epoch 7/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:50<00:00,  1.81it/s] 

----- DEBUG INFO FOR EPOCH 7 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.1888/0.2551/0.2534/0.3343
  -> class 0: count=726, mean_score=0.253592, std=0.026325
  -> class 1: count=726, mean_score=0.256690, std=0.027393
ROC AUC (as-is): 0.5285
-------------------------------------

Epoch [7/10], Avg Train Loss: 0.2670, Validation AUROC: 0.5285
Epoch 8/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:30<00:00,  1.21it/s] 
Epoch 8/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:50<00:00,  1.80it/s] 

----- DEBUG INFO FOR EPOCH 8 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.1791/0.2452/0.2440/0.3274
  -> class 0: count=726, mean_score=0.243866, std=0.026719
  -> class 1: count=726, mean_score=0.246489, std=0.026666
ROC AUC (as-is): 0.5252
-------------------------------------

Epoch [8/10], Avg Train Loss: 0.2490, Validation AUROC: 0.5252
Epoch 9/10 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:46<00:00,  1.10it/s] 
Epoch 9/10 [Val]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [01:04<00:00,  1.41it/s] 

----- DEBUG INFO FOR EPOCH 9 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.1656/0.2208/0.2203/0.2847
  -> class 0: count=726, mean_score=0.219404, std=0.022758
  -> class 1: count=726, mean_score=0.222227, std=0.023374
ROC AUC (as-is): 0.5316
-------------------------------------

Epoch [9/10], Avg Train Loss: 0.2346, Validation AUROC: 0.5316
Epoch 10/10 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 182/182 [02:35<00:00,  1.17it/s]
Epoch 10/10 [Val]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:57<00:00,  1.59it/s] 

----- DEBUG INFO FOR EPOCH 10 -----
DEBUG: len(scores)=1452, len(labels)=1452
DEBUG: labels unique and counts: (array([0, 1]), array([726, 726]))
DEBUG: scores min/mean/median/max: 0.1599/0.2101/0.2093/0.2646
  -> class 0: count=726, mean_score=0.208807, std=0.019508
  -> class 1: count=726, mean_score=0.211457, std=0.020193
ROC AUC (as-is): 0.5359
-------------------------------------

Epoch [10/10], Avg Train Loss: 0.2207, Validation AUROC: 0.5359

Training and validation complete.
Best validation AUROC achieved: 0.0000